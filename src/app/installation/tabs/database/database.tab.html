<div class="page-body row no-gutters">
  
  <!-- db tree -->

  <div class="col-sm-3 ">
    <div class="app-content border-right-0 pl-2">
      <tree-root [nodes]="installationSelectors.dbNodes$ | async" 
        (toggleExpanded)="toggleNode($event)"
        (activate)="selectNode($event)">
        <ng-template #treeNodeTemplate let-node="node">
          <span [ngSwitch]="node.data.type">
            <span *ngSwitchCase="'root'">
            </span>
            <span *ngSwitchCase="'dbFolder'">
              <fa-icon [icon]="['fas', 'folder-open']" *ngIf="node.isExpanded" class="folder"></fa-icon>
              <fa-icon [icon]="['fas', 'folder']" *ngIf="!node.isExpanded" class="folder"></fa-icon>
            </span>
            <span *ngSwitchCase="'dbStream'">
              <fa-icon [icon]="['fas', 'database']"></fa-icon>
            </span>
          </span>
          {{ node.data.name }}
        </ng-template>
        <ng-template #loadingTemplate><fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon> loading</ng-template>
      </tree-root>
    </div>
  </div>
  <!-- folder/stream edits -->
  <div [ngSwitch]='installationSelectors.selectedType$ | async' 
    class='app-content col-sm-9 pl-3 pr-2'>
    <app-edit-db *ngSwitchCase="'root'"
      [db] = "installationSelectors.selectedDb$ | async"
      [rootFolder] = "installationSelectors.selectedDbRootFolder$ | async"
      (refresh) = "refresh(nilm)"></app-edit-db>
    <app-edit-stream *ngSwitchCase="'dbStream'" 
      [dbStream]="installationSelectors.selectedDbStream$ | async" 
      [dbElements]="installationSelectors.selectedDbStreamElements$ | async"></app-edit-stream>
    <app-edit-folder *ngSwitchCase="'dbFolder'" 
      [dbFolder]="installationSelectors.selectedDbFolder$ | async "></app-edit-folder>
  </div>

</div>
