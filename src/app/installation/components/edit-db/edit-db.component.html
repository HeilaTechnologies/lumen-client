<div *ngIf="rootFolder!=null && my_db!=null">
  <div class="panel-title">Database Properties</div>

  <alert type="danger" *ngIf="!my_db.available">
    <fa-icon [icon]="['fas', 'exclamation-triangle']"></fa-icon>
    Cannot contact database, check URL or click refresh
  </alert>

  <dl class="row">
    <dt class="col-2 text-right">Time Range</dt>
    <dd class="col-10" *ngIf="rootFolder && rootFolder.size_on_disk>0">
        {{rootFolder.start_time/1e3 | date:"y MMM dd HH:mm:ss"}} &mdash;
        {{rootFolder.end_time/1e3   | date:"y MMM dd HH:mm:ss"}}
    </dd>
    <dd class="col-10" *ngIf="rootFolder==null || rootFolder.size_on_disk==0"> &mdash;</dd>
    <dt class="col-2 text-right" >Size on Disk</dt>
    <dd  class="col-10">{{rootFolder.size_on_disk | byteSize }}</dd>
    <dt class="col-2 text-right">NilmDB Version</dt>
    <dd class="col-10">{{my_db.version}}</dd>
  </dl>
  
  <form *ngIf="form!=null" [formGroup]="form">
    <div class="form-group" [class.has-error]="!form.controls.url.valid">
      <label class="control-label" for="folder-name">URL</label>
      <input class="form-control" id="folder-name" placeholder="http://mynilm.com" type="text" [formControl]="form.controls.url">
    </div>
    <div class="form-group" 
      [class.has-error]="!form.controls.max_points_per_plot.valid">
      <label class="control-label" for="folder-description">Plot Resolution</label>
      <input class="form-control" id="folder-description" 
        placeholder="max points per plot" type="number" 
        [formControl]="form.controls.max_points_per_plot">
    </div>
    <div class="form-group ">
      <div class="float-left ">
        <button type="submit" (click) = "onSubmit(form.value)" class="btn btn-primary" 
          [disabled]="!form.valid || (busy$ | async)">Save</button>
      </div>
      <div class="float-right ">
        <button class="btn btn-secondary" [disabled]='busy$ | async'
          (click)="refreshDb()">
          <fa-icon [icon]="['fas', 'sync']" [spin]="true" *ngIf='refreshing$ | async'></fa-icon>
          Refresh
        </button>
      </div>
    </div>
  </form>
</div>
  
