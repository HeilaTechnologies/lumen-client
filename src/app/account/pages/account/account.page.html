<div class="page-title-bar">Account Settings</div>
<div class="row">
  
  <!-- === LEFT COLUMN === -->
  <div class="col-sm-3 col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Account Details</h3>
      </div>
      <div class="panel-body full-column">
        <form *ngIf="form!=null" [formGroup]="form">
          <div class="form-group" [class.has-error]="!form.controls.current_password.valid && !form.controls.current_password.pristine">
            <label class="control-label" for="current_password">Current Password</label>
            <input class="form-control" id="current_password" type="password" [formControl]="form.controls.current_password">
          </div>
          <hr/>
          <div class="form-group" [class.has-error]="!form.controls.first_name.valid">
            <label class="control-label" for="first-name">First Name</label>
            <input class="form-control" id="first-name" type="text" [formControl]="form.controls.first_name">
          </div>
          <div class="form-group" [class.has-error]="!form.controls.last_name.valid">
            <label class="control-label" for="last-name">Last Name</label>
            <input class="form-control" id="last-name" type="text" [formControl]="form.controls.last_name">
          </div>
          <div class="form-group" [class.has-error]="!form.controls.email.valid">
            <label class="control-label" for="email">E-mail</label>
            <input class="form-control" id="email" type="email" [formControl]="form.controls.email">
          </div>
          <div class="form-group" [class.has-error]="!form.controls.passwords.controls.password.valid">
            <label class="control-label" for="password">New Password </label>
            <input class="form-control" id="password" type="password" [formControl]="form.controls.passwords.controls.password">
            <span class="help-block"><i>leave blank to keep password unchanged</i></span>
          </div>
          <div class="form-group" [class.has-error]="!form.controls.passwords.valid">
            <label class="control-label" for="password_confirmation">Confirm New Password</label>
            <input class="form-control" id="password_confirmation" type="password" [formControl]="form.controls.passwords.controls.password_confirmation">
            <span *ngIf="!form.controls.passwords.valid" class="help-block danger">passwords must match</span>
          </div>
          <button type="submit" (click)="onSubmit(form.value)" class="btn btn-default " [disabled]="!form.valid">Save</button>
        </form>
      </div>
    </div>
  </div>

  <!-- === MIDDLE COLUMN === -->
  <div class="col-sm-5 col-md-4">
    <!-- Installations -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Installations</h3>
      </div>
      <div *ngIf="accountSelectors.nilmsLoaded$ | async; else loadingnilms"
        class="panel-body half-column">
        <app-account-nilms></app-account-nilms>
      </div>
      <template #loadingnilms>
        <div class="loading-container panel-body half-column">
          <div class="loading">
            <i class="fa fa-spin fa-spinner fa-4x"></i>
            <p class="lead">Loading...</p>
          </div>
        </div>
      </template>
    </div>
    <!-- Data Views -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Saved Views</h3>
      </div>
      <div *ngIf="accountSelectors.dataViewsLoaded$ | async; else loadingviews"
        class="panel-body half-column">
        <app-data-views></app-data-views>
      </div>
      <template #loadingviews>
        <div class="loading-container panel-body half-column">
          <div class="loading">
            <i class="fa fa-spin fa-spinner fa-4x"></i>
            <p class="lead">Loading...</p>
          </div>
        </div>
      </template>
    </div>
  </div>

  <!-- === RIGHT COLUMN === -->
  <div class="col-sm-4">
    <!-- User Groups -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Groups</h3>
      </div>
      <div *ngIf="accountSelectors.userGroupsLoaded$ | async; else loadinggroups"
        class="panel-body full-column">
        <app-account-groups>
        </app-account-groups>
      </div>
      <template #loadinggroups>
        <div class="loading-container panel-body full-column">
          <div class="loading">
            <i class="fa fa-spin fa-spinner fa-4x"></i>
            <p class="lead">Loading...</p>
          </div>
        </div>
      </template>
    </div>
  </div>
</div>